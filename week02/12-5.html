<html lang="ja">

<head>
    <meta charset="utf-8" />

    <script>

        var px;
        var py;
        var ox;
        var oy;
        var count;
        var ctx;

        function x() {
            ctx = document.getElementById('canvas1').getContext('2d');
            ctx.clearRect(0, 0, 400, 300);
            ctx.strokeStyle = '#000000';
            ctx.fillStyle = '#000000';

            px = Math.floor(Math.random() * 39) * 10;
            py = Math.floor(Math.random() * 29) * 10;
            ox = Math.floor(Math.random() * 39) * 10;
            oy = Math.floor(Math.random() * 29) * 10;
            count = 0;

            ctx.beginPath();
            ctx.arc(px, py, 5, 0, Math.PI * 2);
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(ox, oy, 5, 0, Math.PI * 2);
            ctx.fill();
        }
        window.onload = x;

        function buttonUpPressed() {
            ctx.clearRect(0, 0, 400, 300);

            count = count + 1;
            //プレイヤーの動き
            py = py - 10;
            ctx.beginPath();
            ctx.arc(px, py, 5, 0, Math.PI * 2);
            ctx.stroke();
            //敵の動き
            var r = Math.floor(Math.random() * 4);
            if (r == 1 && oy < 290) {
                //上
                oy = oy + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 2 && oy < 290) {
                //下
                oy = oy - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 3 && ox < 390) {
                //右
                ox = ox + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 0 && ox < 390) {
                //左
                ox = ox - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            }
            if (px == ox && py == oy) {
                //クリア画面
                ctx.font = "30px sans-serif";
                ctx.fillText("クリアしました！ステップ数：" + count, 20, 75, 200);
            }
        }


        function buttonLeftPressed() {
            ctx.clearRect(0, 0, 400, 300);

            count = count + 1;
            //プレイヤーの動き
            px = px - 10;
            ctx.beginPath();
            ctx.arc(px, py, 5, 0, Math.PI * 2);
            ctx.stroke();
            //敵の動き
            var r = Math.floor(Math.random() * 4);
            if (r == 1 && 0 < oy < 290) {
                //上
                oy = oy + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 2 && 0 < oy < 290) {
                //下
                oy = oy - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 3 && 0 < ox < 390) {
                //右
                ox = ox + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 0 && ox < 390) {
                //左
                ox = ox - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            }
            if (px == ox && py == oy) {
                //クリア画面
                ctx.font = "30px sans-serif";
                ctx.fillText("クリアしました！ステップ数：" + count, 20, 75, 200);
            }
        }


        function buttonRightPressed() {
            ctx.clearRect(0, 0, 400, 300);

            count = count + 1;
            //プレイヤーの動き
            px = px + 10;
            ctx.beginPath();
            ctx.arc(px, py, 5, 0, Math.PI * 2);
            ctx.stroke();
            //敵の動き
            var r = Math.floor(Math.random() * 4);
            if (r == 1 && oy < 290) {
                //上
                oy = oy + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 2 && oy < 290) {
                //下
                oy = oy - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 3 && ox < 390) {
                //右
                ox = ox + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 0 && ox < 390) {
                //左
                ox = ox - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            }
            if (px == ox && py == oy) {
                //クリア画面
                ctx.font = "30px sans-serif";
                ctx.fillText("クリアしました！ステップ数：" + count, 20, 75, 200);
            }
        }


        function buttonDownPressed() {
            ctx.clearRect(0, 0, 400, 300);

            count = count + 1;
            //プレイヤーの動き
            py = py + 10;
            ctx.beginPath();
            ctx.arc(px, py, 5, 0, Math.PI * 2);
            ctx.stroke();
            //敵の動き
            var r = Math.floor(Math.random() * 4);
            if (r == 1 && oy < 290) {
                //上
                oy = oy + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 2 && oy < 290) {
                //下
                oy = oy - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 3 && ox < 390) {
                //右
                ox = ox + 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            } else if (r == 0 && ox < 390) {
                //左
                ox = ox - 10;
                ctx.beginPath();
                ctx.arc(ox, oy, 5, 0, Math.PI * 2);
                ctx.fill();
            }
            if (px == ox && py == oy) {
                //クリア画面
                ctx.font = "30px sans-serif";
                ctx.fillText("クリアしました！ステップ数：" + count, 20, 75, 200);
            }
        }

    </script>
</head>

<body>
    <div style="position:relative; height:50px;">
        <button style="position:absolute; left: 30px; top: 0px;" onclick="buttonUpPressed()">↑</button>
        <button style="position:absolute; left: 10px; top: 15px;" onclick="buttonLeftPressed()">←</button>
        <button style="position:absolute; left: 50px; top: 15px;" onclick="buttonRightPressed()">→</button>
        <button style="position:absolute; left: 30px; top: 30px;" onclick="buttonDownPressed()">↓</button>
    </div>
    <hr>
    <canvas id="canvas1" width="400" height="300" style="border: solid 1px;"></canvas>
</body>

</html>